# cpp-spreadsheet

A minimal spreadsheet engine written in modern C++ (C++17).  
It supports text cells, formulas, arithmetic operations, error handling, and printing of the final table.  
The project includes:

- A custom formula parser built with **ANTLR4**
- A formula AST interpreter
- Text and formula cell types
- A sparse spreadsheet data structure
- Printable view generation (values & raw text)

This project is implemented as part of a full spreadsheet system similar to Excel, but much smaller and focused on correctness, safety, and clarity.

---

## ðŸš€ Features

### Cells
- Text cells (`"hello"` or `"'=not formula"`).
- Formula cells (`"=1+2*3"`).
- Converts between raw text and display text correctly.
- Supports unary and binary operators (`+ - * /`).

### Formula engine
- Full parser generated by **ANTLR v4**.
- AST-based evaluation engine.
- Detects:
    - Syntax errors (`FormulaException`)
    - Arithmetic errors (`FormulaError`)

### Spreadsheet
- Sparse structure â€” memory efficient.
- Constant-time access to any cell by `Position`.
- Supports printing:
    - **Raw text table**
    - **Computed values table**
- Automatically determines minimal printable area.

---

## ðŸ”§ Build Instructions

### Requirements
- C++17 compiler
- CMake â‰¥ 3.15
- ANTLR4 C++ runtime (included in `antlr4_runtime/`)

### Build

```bash
mkdir build
cd build
cmake ..
make -j8
```

Run
```bash
./spreadsheet
```

---

### ðŸ§ª Tests
The main.cpp file acts as a simple test harness.
It validates:
- Formula parsing
- Formula evaluation
- Error propagation
- Cell type switching
- Printable area detection
- Spreadsheet printing

---

### ðŸ“Œ License
This project was developed for educational purposes.
Use freely, modify, extend â€” no attribution required.

---